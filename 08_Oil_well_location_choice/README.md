# Выбор локации для нефтяной скважины

## Постановка задачи

Нужно решить, где бурить новую скважину.
Классические шаги для выбора локации:
1. В избранном регионе собирают характеристики для скважин: качество нефти и объём её запасов (данные уже собраны);
2. Строят модель для предсказания объёма запасов в новых скважинах;
3. Выбирают скважины с самыми высокими оценками значений;
4. Определяют регион с максимальной суммарной прибылью отобранных скважин.

Предоставлены пробы нефти в трёх регионах. Характеристики для каждой скважины в регионе уже известны. Нужно построить модель для определения региона, где добыча принесёт наибольшую прибыль. Нужно проанализировать возможную прибыль и риски техникой Bootstrap.

**Условия задачи:**
- Для обучения модели подходит только **линейная регрессия** (остальные — недостаточно предсказуемые).
- При разведке региона исследуют 500 точек, из которых с помощью машинного обучения выбирают 200 лучших для разработки.
- Бюджет на разработку скважин в регионе — 10 млрд рублей.
- При нынешних ценах один баррель сырья приносит 450 рублей дохода. Доход с каждой единицы продукта составляет 450 тыс. рублей, поскольку объём указан в тысячах баррелей.
- После оценки рисков нужно оставить лишь те регионы, в которых вероятность убытков меньше 2.5%. Среди них выбирают регион с наибольшей средней прибылью.

## Данные
Данные геологоразведки трёх регионов находятся в файлах:
* /datasets/geo_data_0.csv.
* /datasets/geo_data_1.csv. 
* /datasets/geo_data_2.csv. 
* id — уникальный идентификатор скважины;
* f0, f1, f2 — три признака точек (неважно, что они означают, но сами признаки значимы);
* product — объём запасов в скважине (тыс. баррелей).

Данные синтетические: детали контрактов и характеристики месторождений не разглашаются.

## План исследования:

1. Загрузить и подготовить данные. 
2. Обучить и проверить модель для каждого региона, определить средний запас предсказанного сырья и RMSE модели.
3. Рассчитать достаточный объём сырья для безубыточной разработки новой скважины. Сравнить полученный объём сырья со средним запасом в каждом регионе.
4. Создание функции для расчёта прибыли по выбранным скважинам и предсказаниям модели:
    4.1. Выбрать скважины с максимальными значениями предсказаний.
    4.2. Просуммировать целевое значение объёма сырья, соответствующее этим предсказаниям.
    4.3. Рассчитать прибыль для полученного объёма сырья.
5. Посчитать риски и прибыль для каждого региона:
    5.1. Применить технику Bootstrap с 1000 выборок, чтобы найти распределение прибыли.
    5.2. Найти среднюю прибыль, 95%-й доверительный интервал и риск отрицательной прибыли (убытков).
    5.3. Предложить регион для разработки скважин.

Для исследования использованы библиотеки Pandas, sklearn, numpy, scipy

## Итоги исследования 

В ходе выбора локации для новой скважины было выполнено:
1. Загружены и изучены данные. При анализе гистограмм выявлено, что распределения product — объём запасов в скважине и оценок для первого и третьего регионов близки к нормальному. т.е. скаважин с максимальной продуктивностью относительно мало. Для второго региона объём и оценка f2 не нормальны,  распределение объема ближе к равномерному, но с выбросами по краям, т.е. скважин с высокой продуктивностью относительно много. 

2. Обучена и проверена модель для каждого региона. Определены средний запас предсказанного сырья и RMSE модели для каждого региона и общие.

Рассмотрено два варианта построения моделей: одна общая для всех регионов; три отдельных для каждого региона. Предпочтительнее обучать для каждого региона свою отдельную модель, так при этом улучшаются все метрики.

Максимальный коэффициент детерминации R2 наблюдается для второго региона и  достигает 1 (0.9996). Для первого и третьего регионов R2 менее 0,3, что говорит о невысоком качестве моделей, но лучшем, чем у константной модели. 
Максимально предсказываемые объемы продукта наблюдаются для 1-го и 3-го регионов, реальные максимальные запасы также расположены в этих регионах (92,08 и 94,75 тыс. баррелей). Во втором регионе предсказаны и реально содержаться минимальные средние запасы (68,77 тыс. баррелей). В третьем регионе максимальные среднеквадратическое и средне абсолютное отклонения, а минимальные - во втором регионе.

3. Рассчитан достаточный объём сырья для безубыточной разработки новой скважины. Выполнено сравнение полученного объёма сырья со средним запасом в каждом регионе. Для безубыточной разработки нового нефтяного региона (200 скважин) необходимый объем сырья региона должен составлять 22,(2) млн. баррелей, тогда средний объем каждой скважины должен быть не меньше 111,(1) тыс. баррелей, что заменто превосходит средний объем скважин валидационной выборки.
4. Подготовлена функция для расчёта прибыли по выбранным скважинам и предсказаниям модели, которая выбирает скважины с максимальными значениями предсказаний, рассчитывает объём сырья и соответсвующую прибыль.
5. Расчет рисков и доверительного интервала прибыли для каждого региона
* Применена техника Bootstrap с 1000 выборок, чтобы найти распределение прибыли.
* Найдена средняя прибыль, 95%-й доверительный интервал и риск убытков для каждого региона.

Для разработки скважин подходит только второй регион с риском убытков в 0,7%, для первого и третьего региона риски убытков 6,5% и 9,9%, т.е. больше заданного порога в 2,5%. Также во втором регионе максимальная средняя прибыль с наиболее узким доверительным интервалом. Несмотря на то, что согласно Шагу 2 во втором регионе наименьшая средняя прибыль, регион оказывается единственным подходящим для разработки скважин. Это может быть объяснено тем, что продуктивность скважин 2го региона полностью предсказуема (R2 = 0,9996). Кроме того, согласно гистограммам Шага 1 в регионе имеется две моды в области низких и высоких продуктивностей и за счет полной предсказуемости, могут быть выбраны 200 скважин с действительно высокой продуктивностью.

Итак, отвечая на главный вопрос проекта "где бурить новую скважину?", можно рекомендавать второй регион, при этом выбор лучших скважин должна осуществлять модель, обученная только на данных этого региона.
