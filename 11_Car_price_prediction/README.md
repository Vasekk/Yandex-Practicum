# Определение стоимости автомобилей (проект закончен)

## Постановка задачи

Сервис по продаже автомобилей с пробегом «Не бит, не крашен» разрабатывает приложение для привлечения новых клиентов. В нём можно быстро узнать рыночную стоимость своего автомобиля. В  распоряжении исторические данные: технические характеристики, комплектации и цены автомобилей. Нужно построить модель для определения стоимости.

Заказчику важны:
- качество предсказания;
- скорость предсказания;
- время обучения.

## Данные

Данные хранятся в файле autos.csv и содержат следующие признаки:

* DateCrawled — дата скачивания анкеты из базы
* VehicleType — тип автомобильного кузова
* RegistrationYear — год регистрации автомобиля
* Gearbox — тип коробки передач
* Power — мощность (л. с.)
* Model — модель автомобиля
* Kilometer — пробег (км)
* RegistrationMonth — месяц регистрации автомобиля
* FuelType — тип топлива
* Brand — марка автомобиля
* NotRepaired — была машина в ремонте или нет
* DateCreated — дата создания анкеты
* NumberOfPictures — количество фотографий автомобиля
* PostalCode — почтовый индекс владельца анкеты (пользователя)
* LastSeen — дата последней активности пользователя
* Price — цена (евро) - Целевой признак

## План исследования:

1. Подготовка данных
2. Обучение моделей
3. Анализ моделей

Для исследования использованы библиотеки Pandas, sklearn, lightgbm, catboost, numpy, phik

## Итоги исследования 

1. Загружены, проанализированы и подготовлены данные объявлений о продаже машин. Обработаны пропуски и аномалии в данных
2. Закодированы категориальные признаки, подготовлены обучающая и тестовая выборкию Обучены 5 различных моделей регрессии с предустановленными гиперпараметрами. Лучшее качество у модели CatBoostRegressor.
3. Выполнен подбор гиперпараметров (RandomizedSearchCV) моделей LGBMRegressor и CatBoostRegressor. Рекомендована модель CatBoostRegressor с гиперпараметрами max_depth=12, n_estimators=500.  Данная модель имеет наилучшее качество, высокую скорость предсказания (в ~10 раз быстрее LGBMRegressor), но примерно в 10 раз дольшее обучение (чем LGBMRegressor). Метрика CV_RMSE=1501, время обучения 48 s, время предсказания 176 ms.