# Модель оттока клиентов «Бета-Банка» (проект закончен)

## Постановка задачи 

Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.
Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Имеются исторические данные о поведении клиентов и расторжении договоров с банком.

Цель проекта - построить модель с предельно большим значением F1-меры, дополнительно измеряя AUC-ROC и  сравнивая её значение с F1-мерой.

## Данные
Данные хранятся в файле "Churn.csv". Данные содержат 10000 записей. Каждая строка в наборе данных — это информация об одном пользователе. Описание признаков:
- RowNumber — индекс строки в данных
- CustomerId — уникальный идентификатор клиента
- Surname — фамилия
- CreditScore — кредитный рейтинг
- Geography — страна проживания
- Gender — пол
- Age — возраст
- Tenure — сколько лет человек является клиентом банка
- Balance — баланс на счёте
- NumOfProducts — количество продуктов банка, используемых клиентом
- HasCrCard — наличие кредитной карты
- IsActiveMember — активность клиента
- EstimatedSalary — предполагаемая зарплата
- Exited — факт ухода клиента (Целевой признак)

## План исследования:

1. Загрузить и подготовить данные.
2. Исследовать баланс классов, обучить модель без учёта дисбаланса.
3. Улучшить качество модели, учитывая дисбаланс классов. Обучить разные модели и найти лучшую.
4. Провести финальное тестирование.

Для исследования использованы библиотеки Pandas и sklearn.

## Итоги исследования 

В ходе разработки модели классификации для прогнозирования оттока клиентов  «Бета-Банка» было выполнено: 
1. Открыты и изучены данные. 

Обработаны пропуски в длительностях обслуживания (tenure).

Подготовлены признаки: удалены незначимые; прямым кодированием закодированы категориальные; созданы обучающая, валидационная и тестовая выборки (3:1:1); выполнено масштабирование численных признаков

2. Исследован баланс классов, обучены модели без учёта дисбаланса

Доли классов 0 - 0.79, 1 - 0.21

| Model| Accuracy| F1| ROC-AUC|
|:--|:--|:--|:--|
|Решающее дерево| 0.79| 0.49|0.68|
|Случайный лес| 0.86| 0.55|0.83|
|Логистическая регрессия| 0.81| 0.30|0.77|
|Константная модель| 0.80| | |

Качество (accuracy) моделей сопоставимо с константной моделью, что обусловлено сильным дисбалансом классов целевого признака.

3. Для учета дисбаланса рассмотрены три медота: Взвешивание, Upsampling, Downsampling. Максимальные метрики f1 и auc-roc моделей классификации наблюдаются при использовании upsampling для модели случайного леса (f1 = 0.59, AUC-ROC = 0.83). При улучшении данной модели подбором гиперпараметров метрики могут быть увеличены до 0.623 и 0.853 соответственно. Гиперпараметры лучшей модели depth: 9, criterion: gini, n_estimator: 20, min_samples_split: 38.

4. Проверено качество моделей на тестовой выборке. Метрики составили:
| Accuracy| F1| ROC-AUC| полнота| точность|
|:--|:--|:--|:--|:--|
| 0.815| 0.616|0.862|0.734| 0.531|

Метрики близки к значениям валидационных метрик.


Таким образом, обучена модель, позволяющая прогнозировать отток клиентов «Бета-Банка». На тестовой выборке из предсказанных уходов 73% клиентов действительно ушли, 27% остались. Из всех ушедщих клиентов модель предсказала каждого второго (53%), банк может попытаться сохранить этих клиентов. Если банк будет сохранять предсказнных моделью уходящих клиентов, то около четверти расходов (27%) будет избыточна (потрачена на не уходящих клиентов), поэтому стоимость сохранения клиента не должна превышать 73% стоимости привлечения новых клиентов, иначе действия по сохранению нецелесообразны.
