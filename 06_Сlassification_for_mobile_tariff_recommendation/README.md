# Модель классификации для выбора подходящего мобильного тарифа (проект закончен)

## Постановка задачи 

Оператор мобильной связи «Мегалайн» выяснил: многие клиенты пользуются архивными тарифами. Они хотят построить систему, способную проанализировать поведение клиентов и предложить пользователям новый тариф: «Смарт» или «Ультра».
В распоряжении данные о поведении клиентов, которые уже перешли на эти тарифы. Нужно построить модель для задачи классификации, которая выберет подходящий тариф. Предобработка данных не требуется, так как была сделана ранее.
Цель работы - построить модель классификации с максимальным Accuracy.

## Данные
Данные хранятся в файле "users_behavior.csv" и содержат следующую информацию о поведении клиентов:
сalls — количество звонков,
minutes — суммарная длительность звонков в минутах,
messages — количество sms-сообщений,
mb_used — израсходованный интернет-трафик в Мб,
is_ultra — каким тарифом пользовался в течение месяца («Ультра» — 1, «Смарт» — 0).

## План исследования:

1. Открыть файл с данными и изучить его. Путь к файлу: datasets/users_behavior.csv. 
2. Разделить исходные данные на обучающую, валидационную и тестовую выборки.
3. Исследовать качество разных моделей, меняя гиперпараметры.
4. Проверить качество модели на тестовой выборке.
5. Проверить модели на вменяемость. 

Для исследования использованы библиотеки Pandas, sklearn.

## Итоги исследования 

В ходе разработки модели классификации для выбора подходящего тарифа оператора "Мегалайн" было выполнено: 
1. Открыт и изучен файл с данными.
2. Исходные данные разделены на обучающую, валидационную и тестовую выборки в пропорции 3:1:1. Выделены признаки: количество минут, сообщений и интернет трафика. Выделен целевой признак - тариф.
3. Построены модели классификации: решающее дерево, случайный лес, логистическая регрессия. Исследовано влияние гиперпараметров на качество моделй. Выбраны наилучшие модели каждлго типа. 
4. Проверено качество моделей на тестовой выборке. 
5. Модели проверены на адекватность. Качество всех разработанных моделей выше качества константной модели.

Дополнительно для анализа корректности результатов работы модели предсказаны тарифы для характерных использований услуг связи: 
1-3. полностью использован лимит одной из услуг тарифа; 4. полностью использован лимит всех услуг тарифа; 5. использована половина лимита каждой услуги.
В результате анализа установлено: 
- модель случайного леса при полном использовании только одной из 3х услуг тарифа Смарт рекомендует перейти на тариф Ультра, что не может считаться корректной рекомендацией, однако при использовании всех услуг пакета (полностью или половины) правильно рекомендует использовать тариф Смарт.
- модель решающего дерева имеет схожие проблемы: при полном использовании сообщений или минут пакета смарт некорректно рекомендует перейти на тариф Ультра, при полном использовании пакета сообщений тарифа Ультра некорректно рекомендует перейти на тариф Смарт.
- модель логистической регрессии выдает наиболее адекватные рекомендации, но некорректно рекомендует перейти на смарт только при использовании полного  пакета интернета тарифа Ультра

Итак, модели Решающее дерево и Случайный лес имеют сравнимые accuracy на валидационной выборке - (0.8072 и 0.8056) и на тестовой выборке - (0,7729 и 0,7807 соответственно). Для логистической регрессии качество модели заметно ниже: на валидационной - 0,7589, на тестовой - 0,7262. При этом качество всех разработанных моделей выше качества константной модели (0.69).

Рекомендуемая модель - модель решающего дерева (с наибольшим accuracy на валидационной выборке) с гиперпараметрами: max_depth - 12, criterion - gini, splitter - random, min_samples_split - 11. Однако в ее работе прослеживаются некорректные рекомендации: при полном использовании сообщений(1) или минут(2) пакета Смарт некорректно рекомендуется переход на тариф Ультра, а при полном использовании только пакета сообщений(3) тарифа Ультра - переход на тариф Смарт. При этом финансовые затраты от таких рекомендаций могут сокращаться, например, для рекомендации (3) оплата сократиться на 450 р., но построенная модель обучалась только на поведении пользователей и ничего не знает о деньгах. Поэтому для улучшения предсказаний можно учесть стоимости тарифов и услуг сверх тарифа.
