# Восстановление золота из руды

## Постановка задачи

Подготовить прототип модели машинного обучения для «Цифры». Компания разрабатывает решения для эффективной работы промышленных предприятий.

Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды, используя данные с параметрами добычи и очистки.

Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

## Данные
Данные находятся в файлах:
* gold_recovery_train_new.csv.
* gold_recovery_test_new.csv.
* gold_recovery_full_new.csv.

размеры выборок: (14149, 87), (5290, 53), (19439, 87), файл full содержит в себе выборки train и test. Каждая запись содержит время и 86 числовых параметров техпроцесса.

В тестовой выборке некоторые параметры недоступны, потому что замеряются и/или рассчитываются значительно позже. 
В тестовой выборке находятся параметры, которые доступны в масштабе близком к реальному времени и по которым необходимо принимать решения об управлении процессом обогащения, т.е. обучать модель.


## План исследования:

1. Подготовить данные;
2. Провести исследовательский анализ данных;
3. Построить и обучить модель.

Для исследования использованы библиотеки Pandas, sklearn, numpy, scipy, matplotlib.

## Итоги исследования 

В ходе работы было выполнено:
1. Подготовка данных
- загрузка и просмотр файлов
- проверена корректность вычисления рассчитываемых параметров (эффективности обогащения) в выборках
- определены отсутсвующие в тестовой выборке параметры. 
- обработаны пропуски


2. Анализ данных

- Рассмотрено изменение концентрация металлов (Au, Ag, Pb) на различных этапах очистки.
* Средняя концентрация золота на каждом этапе увеличивается с 8% до 20, 32 и 44 %
* Средняя концентрация серебра имеет максимум  12% после флотации, затем снижается до 5%. 
* Средняя концентрация свинца монотонно увеличивается
* Средняя концентрация sol (коллоида) уменьшается с 36% до 9%

- В результате сравнения средних размеров гранул в обучающей и тестовой выборках установлено, что средние значения статистически не равны, распределние гранул после флотации близко к нормальному, распределение перед флотацией для тестовой выборки - бимодальное , оба тестовых распределения статистически смещены влево. Эти отлиичя могут повлиять на качество модели.

- Средняя суммарная концентрация отслеживаемых веществ на разных стадиях: в сырье, в черновом и финальном концентратах сохраняется в диапазоне 56-69%. Гистрограммы суммарной концентрации на входе и выходе первичной очистки имеют аномальные нулевые значени, аномалии усключены.
В ходе очистки суммарная концентрация металлов растет.

3. Построена и протестирована модель прогнозирования 

- Создана функция, подсчитывающая итоговый sMape (в долях, не в %).

- Выполнено разделение целевых признаков, из обучающей выборки выделена валидационная. Выполнено масштабирование признаков. Обучены модели: Линейная регрессия, Дерево решений в регрессии, Случайный лес в регрессии. На валидационной выборке для моделей расчитана метрика  итоговый sMAPE: 8.61%, 8.51% и 6.36% соответсвенно. Для константной модели метрика равна 9.32%.

- Для тестовой выборки восстановлены целевые признаки из массива исходных данных (файл full). 
По результатам кросс-валидации sMAPE моделей: 9.61%, 14.74%, 9.67%. Лучшая модель - Линейная регрессия. 
Выполнена проверка лучшей модели на тестовой выборке: sMAPE = 9.32% немного лучше, чем для константной модели (9,95 %).

Таким образом, подготовлен прототип модели машинного обучения для предсказания коэффициента восстановления золота из золотосодержащей руды. Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

